<div >
  <div id="map" >
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script>
      function initialize(listings){
        var location = {lat: 44.5403, lng: -78.5463}

        if (listings.length > 0) {
          location = {lat: listings[0].latitude, lng: listings[0].longitude }
        }

        var map = new google.maps.Map(document.getElementById('map'), {
          center: location,
          zoom: 12
        });

        var marker, infowindow;

        listings.forEach(function(listing){
          marker = new google.maps.Marker({
            position: {lat:  listing.latitude , lng:  listing.longitude },
            map: map
          });

          infowindow = new google.maps.InfoWindow({
            content: "<div class='map_price'>$" + listing.price + "</div>"

          });
          infowindow.open(map, marker);
        })

      }
      google.maps.event.addDomListener(window, 'load', function() {
        initialize(<%= raw @arrListings.to_json %>)
      });
    </script>
  </div>
</div>
